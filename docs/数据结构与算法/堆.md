# 堆有序

- 当一棵二叉树的每个结点都**大于等于它的两个子结点**时，被称为堆有序
- 根结点是堆有序二叉树中的最大结点

# 二叉堆

- 二叉堆 / 堆：一组能够用**堆有序**的**完全二叉树**排序的元素，并在数组中按照层级存储（**不使用数组的第一个位置**）
- 在一个堆中，位置$k$的结点的父结点的位置为$floor(k/2)$，其两个子结点的位置分别为$2k$和$2k+1$
- 一棵大小为$N$的完全二叉树的高度为$floor(lgN)$

# 堆有序化

## 由下至上的堆有序化（上浮）

- 当某个结点变得比其父结点更大
- 用于优先队列的插入元素操作，不超过$(lgN+1)$次比较

```java
private void swim(int k) {
	while(k > 1 && pq[k/2] < pq[k]) { // 堆有序不使用数组第一个位置
        交换pq[k/2]和pq[k];
        k = k/2;
    }
}
```

## 由上至下的堆有序化（下沉）

- 当某个结点变得比其两个子结点或其中之一更小
- 用于优先队列的删除最大元素操作，不超过$2lgN$次比较

```java
private void sink(int k) {
	while(2*k <= N) {
        int j = 2*k;
        if(j < N && pq[j] < pq[j+1]) j++;
        if(pq[k] > pq[j]) break;
        交换pq[k]和pq[j];
        k = j;
    }
}
```

# 堆排序

```java
public static void heapSort(Comparable[] a) {
	int N = a.length;
    // 堆的构造
    for(int k = N/2; k >= 1; k--) sink(a, k, N);
    // 下沉排序
    while(N > 1) {
        交换a[1]和a[N--];
        sink(a, 1, N);
    }
}
```

- 时间复杂度：$O(NlgN)$
- 空间复杂度：$O(1)$